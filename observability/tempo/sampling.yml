tail_sampling:
  decision_wait: 30s
  num_traces: 50000
  expected_new_traces_per_sec: 1000
  policies:
    - name: errors-policy
      type: status_code
      status_code:
        status_codes:
          - ERROR
          - UNSET

    - name: high-latency-policy
      type: latency
      latency:
        threshold_ms: 3000

    - name: payment-service-policy
      type: string_attribute
      string_attribute:
        key: service.name
        values:
          - order-payment-service
        enabled_regex_matching: false
        invert_match: false

    - name: auth-service-policy
      type: string_attribute
      string_attribute:
        key: service.name
        values:
          - auth-service
        enabled_regex_matching: false
        invert_match: false

    - name: stripe-webhook-policy
      type: string_attribute
      string_attribute:
        key: http.route
        values:
          - /v1/webhooks/stripe
        enabled_regex_matching: false
        invert_match: false

    - name: appointment-booking-policy
      type: string_attribute
      string_attribute:
        key: http.route
        values:
          - /v1/appointments
        enabled_regex_matching: false
        invert_match: false

    - name: probabilistic-policy
      type: probabilistic
      probabilistic:
        sampling_percentage: 10

    - name: rate-limiting-policy
      type: rate_limiting
      rate_limiting:
        spans_per_second: 500

head_sampling:
  - service_name: order-payment-service
    sampling_percentage: 100

  - service_name: auth-service
    sampling_percentage: 50

  - service_name: appointment-service
    sampling_percentage: 50

  - service_name: api-gateway
    sampling_percentage: 20

  - service_name: product-service
    sampling_percentage: 10

  - service_name: content-service
    sampling_percentage: 10

  - service_name: customer-service
    sampling_percentage: 20

  - service_name: notification-service
    sampling_percentage: 30

  - service_name: analytics-service
    sampling_percentage: 5

  - service_name: default
    sampling_percentage: 10