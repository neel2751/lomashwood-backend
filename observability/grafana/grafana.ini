##################### Grafana Configuration â€” Lomash Wood #####################

#################################### Paths ####################################
[paths]
data = /var/lib/grafana
temp_data_lifetime = 24h
logs = /var/log/grafana
plugins = /var/lib/grafana/plugins
provisioning = /etc/grafana/provisioning

#################################### Server ###################################
[server]
protocol = https
http_addr =
http_port = 3000
domain = grafana.lomashwood.com
enforce_domain = true
root_url = https://grafana.lomashwood.com
serve_from_sub_path = false
router_logging = false
static_root_path = public
enable_gzip = true
cert_file = /etc/grafana/certs/grafana.crt
cert_key = /etc/grafana/certs/grafana.key
socket_gid =
socket_mode =
socket =
cdn_url =
read_timeout = 0

#################################### Database #################################
[database]
type = postgres
host = grafana-db.lomash-wood.svc.cluster.local:5432
name = grafana
user = grafana_user
password = ${GF_DATABASE_PASSWORD}
ssl_mode = require
max_idle_conn = 2
max_open_conn = 0
conn_max_lifetime = 14400
log_queries =
cache_mode = private

#################################### Cache ####################################
[cache]
type = redis
connstr = addr=redis.lomash-wood.svc.cluster.local:6379,pool_size=100,db=2,prefix=grafana

#################################### Data proxy ###############################
[dataproxy]
logging = false
timeout = 30
dialTimeout = 10
keep_alive_seconds = 30
tls_handshake_timeout_seconds = 10
expect_continue_timeout_seconds = 1
max_conns_per_host = 0
max_idle_connections = 100
idle_conn_timeout_seconds = 90
send_user_header = false
response_limit = 0
row_limit = 1000000

#################################### Analytics ################################
[analytics]
reporting_enabled = false
check_for_updates = false
check_for_plugin_updates = false
feedback_links_enabled = false
google_analytics_ua_id =
google_tag_manager_id =

#################################### Security #################################
[security]
disable_initial_admin_creation = false
admin_user = admin
admin_password = ${GF_SECURITY_ADMIN_PASSWORD}
admin_email = devops@lomashwood.com
secret_key = ${GF_SECURITY_SECRET_KEY}
encryption_provider = secretKey.v1
available_encryption_providers =
disable_gravatar = true
data_source_proxy_whitelist =
disable_brute_force_login_protection = false
cookie_secure = true
cookie_samesite = strict
allow_embedding = false
strict_transport_security = true
strict_transport_security_max_age_seconds = 86400
strict_transport_security_preload = true
strict_transport_security_subdomains = true
x_content_type_options = true
x_xss_protection = true
content_security_policy = true
content_security_policy_template = """script-src 'self' 'unsafe-eval' 'unsafe-inline' 'strict-dynamic' $NONCE;object-src 'none';font-src 'self';style-src 'self' 'unsafe-inline' blob:;img-src * data:;base-uri 'self';connect-src 'self' grafana.lomashwood.com ws://grafana.lomashwood.com/ wss://grafana.lomashwood.com/;manifest-src 'self';media-src 'none';form-action 'self';"""
angular_support_enabled = false
csrf_trusted_origins = grafana.lomashwood.com
csrf_additional_headers = X-Custom-Header

#################################### Snapshots ################################
[snapshots]
external_enabled = false
external_snapshot_url =
external_snapshot_name = Publish to snapshot.raintank.io
public_mode = false
snapshot_remove_expired = true

#################################### Dashboards ##############################
[dashboards]
versions_to_keep = 20
min_refresh_interval = 10s
default_home_dashboard_path = /var/lib/grafana/dashboards/api-gateway-dashboard.json

#################################### Users ####################################
[users]
allow_sign_up = false
allow_org_create = false
auto_assign_org = true
auto_assign_org_id = 1
auto_assign_org_role = Viewer
verify_email_enabled = false
login_hint = email or username
password_hint = password
default_theme = dark
default_language = en-GB
home_page =
editors_can_admin = false
viewers_can_edit = false
hidden_users =

#################################### Auth ####################################
[auth]
login_cookie_name = grafana_session
login_maximum_inactive_lifetime = 7d
login_maximum_lifetime = 30d
token_rotation_interval_minutes = 10
disable_login_form = false
disable_signout_menu = false
signout_redirect_url =
oauth_auto_login = false
oauth_state_cookie_max_age = 600
api_key_max_seconds_to_live = -1
sigv4_auth_enabled = false
sigv4_verbose_logging = false
azure_auth_enabled = false

#################################### Anonymous access ########################
[auth.anonymous]
enabled = false
org_name = Lomash Wood
org_role = Viewer
hide_version = true

#################################### Google OAuth ############################
[auth.google]
enabled = false
allow_sign_up = false
auto_login = false
client_id = ${GF_AUTH_GOOGLE_CLIENT_ID}
client_id_file =
client_secret = ${GF_AUTH_GOOGLE_CLIENT_SECRET}
client_secret_file =
scopes = openid email profile
auth_url = https://accounts.google.com/o/oauth2/auth
token_url = https://accounts.google.com/o/oauth2/token
api_url = https://www.googleapis.com/oauth2/v1/userinfo
allowed_domains = lomashwood.com
hosted_domain = lomashwood.com
skip_org_role_sync = false
use_pkce = true
use_refresh_token = true
tls_skip_verify_insecure = false

#################################### GitHub Auth #############################
[auth.github]
enabled = false
allow_sign_up = false
auto_login = false
client_id = ${GF_AUTH_GITHUB_CLIENT_ID}
client_secret = ${GF_AUTH_GITHUB_CLIENT_SECRET}
scopes = user:email,read:org
auth_url = https://github.com/login/oauth/authorize
token_url = https://github.com/login/oauth/access_token
api_url = https://api.github.com/user
allowed_organizations = lomash-wood
team_ids =
skip_org_role_sync = false
use_pkce = true

#################################### SMTP ###################################
[smtp]
enabled = true
host = email-smtp.eu-west-1.amazonaws.com:587
user = ${GF_SMTP_USER}
password = ${GF_SMTP_PASSWORD}
cert_file =
key_file =
skip_verify = false
from_address = grafana@lomashwood.com
from_name = Lomash Wood Grafana
ehlo_identity =
startTLS_policy = MandatoryStartTLS

#################################### Logging ################################
[log]
mode = console file
level = warn
filters =

[log.console]
level =
format = json

[log.file]
level =
format = json
log_rotate = true
max_lines = 1000000
max_size_shift = 28
daily_rotate = true
max_days = 7

#################################### Metrics ################################
[metrics]
enabled = true
interval_seconds = 10
disable_total_stats = false
basic_auth_username = prometheus
basic_auth_password = ${GF_METRICS_BASIC_AUTH_PASSWORD}

[metrics.graphite]
address =
prefix = prod.grafana.%(instance_name)s.

#################################### Grafana.com integration #################
[grafana_com]
url = https://grafana.com

#################################### Distributed tracing #####################
[tracing.jaeger]
address =
always_propagate_span_context = false

[tracing.opentelemetry]
address =
propagation =

[tracing.opentelemetry.jaeger]
address =
propagation =

[tracing.opentelemetry.otlp]
address = tempo.monitoring.svc.cluster.local:4317
propagation = w3c

#################################### External image storage ##################
[external_image_storage]
provider = s3

[external_image_storage.s3]
endpoint =
path_style_access = false
bucket_url =
bucket = lomash-wood-grafana-images
region = eu-west-1
path = /
access_key = ${GF_EXTERNAL_IMAGE_S3_ACCESS_KEY}
secret_key = ${GF_EXTERNAL_IMAGE_S3_SECRET_KEY}

#################################### Alerting ################################
[alerting]
enabled = false

#################################### Unified Alerting ########################
[unified_alerting]
enabled = true
disable_jira_integration = false
ha_listen_address = ${POD_IP}:9094
ha_advertise_address = ${POD_IP}:9094
ha_peers =
ha_peer_timeout = 15s
ha_gossip_interval = 200ms
ha_push_pull_interval = 60s
ha_reconnect_timeout = 2m
execute_alerts = true
evaluation_timeout = 30s
max_attempts = 3
min_interval = 10s

[unified_alerting.screenshots]
capture = true
capture_timeout = 10s
max_concurrent_screenshots = 5
upload_external_image_storage = true

[unified_alerting.reserved_labels]
disabled_labels =

#################################### Rendering ##############################
[rendering]
server_url = http://grafana-renderer.monitoring.svc.cluster.local:8081/render
callback_url = https://grafana.lomashwood.com/
concurrent_render_request_limit = 30
render_key_lifetime = 5m

#################################### Feature Toggles ########################
[feature_toggles]
enable = publicDashboards,lokiQuerySplitting,lokiShardSplitting,tempoSearch,tempoBackendSearch,tempoServiceGraph,tempoApmTable

#################################### Panels ##################################
[panels]
enable_alpha = false
disable_sanitize_html = false

#################################### Plugins #################################
[plugins]
enable_alpha = false
app_tls_skip_verify_insecure = false
allow_loading_unsigned_plugins =
plugin_admin_enabled = true
plugin_admin_external_manage_enabled = false
plugin_catalog_url = https://grafana.com/grafana/plugins/
plugin_catalog_hidden_plugins =

#################################### Quota ##################################
[quota]
enabled = false

#################################### Live ####################################
[live]
max_connections = 100
allowed_origins = https://grafana.lomashwood.com
ha_engine =
ha_engine_address =

#################################### Enterprise ##############################
[enterprise]
license_path =