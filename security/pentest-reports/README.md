# Penetration Test Reports â€” Lomash Wood Security

This directory contains the official annual penetration test reports for the Lomash Wood backend platform. All reports are classified **Confidential â€” Internal Use Only**.

---

## Reports Index

| File | Year | Reference | Assessment Type | Scope | Overall Severity |
|---|---|---|---|---|---|
| `pentest-2025.pdf` | 2025 | LW-PENTEST-2025-001 | Grey-Box â€” Web Application & API | API Gateway + 7 microservices | 2 Critical, 4 High, 5 Medium |
| `pentest-2026.pdf` | 2026 | LW-PENTEST-2026-001 | Black-Box â€” Web Application, API & Infrastructure | API Gateway + 8 microservices + K8s + AWS | 0 Critical, 2 High, 4 Medium |

---

## Engagement Summary

### pentest-2025.pdf â€” First Annual Assessment

**Assessment Period:** 03 March 2025 â€“ 14 March 2025  
**Conducted By:** CyberSec Partners Ltd  
**Report Issued:** 21 March 2025  
**Assessment Mode:** Grey-Box (OpenAPI spec + non-privileged test account provided)

**Total Findings: 14**

| Severity | Count | Remediated | Open |
|---|---|---|---|
| Critical | 2 | 2 | 0 |
| High | 4 | 3 | 1 |
| Medium | 5 | 4 | 1 |
| Low | 2 | 2 | 0 |
| Info | 1 | N/A | N/A |

**Critical Findings (both remediated):**
- `LW-001` â€” Client-Controlled Payment Amount (CVSS 9.8): Payment intent creation accepted amount from client request body; server-side validation absent
- `LW-002` â€” JWT Algorithm Confusion RS256â†’HS256 (CVSS 9.1): Auth middleware accepted both algorithms; enabled forging of ADMIN-role tokens using the public key

**Key Observations (2025):**
- Parameterised queries (Prisma ORM) and HTTPS enforcement already in place
- No SQL injection or command injection vulnerabilities identified
- Core weaknesses concentrated in application logic controls (payment validation, IDOR, rate limiting) rather than foundational infrastructure

---

### pentest-2026.pdf â€” Second Annual Assessment

**Assessment Period:** 09 February 2026 â€“ 19 February 2026  
**Conducted By:** CyberSec Partners Ltd  
**Report Issued:** 19 February 2026  
**Assessment Mode:** Black-Box (no credentials, source code, or architecture documentation provided)

**Total Findings: 9**

| Severity | Count | 2025 Comparison | Open |
|---|---|---|---|
| Critical | 0 | â–¼ -2 | 0 |
| High | 2 | â–¼ -2 | 2 |
| Medium | 4 | â–¼ -1 | 4 |
| Low | 2 | = 0 | 2 |
| Info | 1 | = 0 | N/A |

**High Findings (both open as of report date):**
- `LW26-001` â€” Loyalty Points Manipulation via Mass Assignment (CVSS 8.3): Loyalty update schema did not exclude the `points` field; customers could self-assign arbitrary point balances
- `LW26-002` â€” Server-Side Request Forgery in Media URL Fetcher (CVSS 7.7): URL fetch endpoint accepted internal AWS metadata service addresses

**Key Observations (2026):**
- All 2025 Critical and High findings (except LW-006 which was confirmed remediated in this retest) have been successfully remediated
- The 2026 findings are concentrated in **newly deployed features** (loyalty programme, enhanced upload pipeline, analytics ingestion API)
- No SQL injection, XSS, or authentication bypass vulnerabilities identified â€” indicating strong adoption of 2025 recommendations
- Black-box assessment methodology demonstrated that the platform's attack surface is not trivially enumerable from the outside

**Year-on-Year Security Score:** Total finding count reduced by 36% (14 â†’ 9); Critical findings eliminated; overall risk profile improved from High to Medium

---

## Remediation Status Tracker

| ID | Finding | 2025 Severity | Current Status |
|---|---|---|---|
| LW-001 | Client-Controlled Payment Amount | Critical | âœ… Remediated (confirmed 2025 retest + 2026 black-box) |
| LW-002 | JWT Algorithm Confusion | Critical | âœ… Remediated (confirmed 2025 retest + 2026 black-box) |
| LW-003 | IDOR on Appointment Booking | High | âœ… Remediated |
| LW-004 | Missing Rate Limiting on Auth | High | âœ… Remediated |
| LW-005 | Stripe Webhook Replay | High | âœ… Remediated |
| LW-006 | Verbose Error Messages | High | âœ… Remediated (confirmed 2026 black-box) |
| LW-007 | User Enumeration via Password Reset | Medium | âœ… Remediated |
| LW-008 | Missing CSRF Protection | Medium | âœ… Remediated |
| LW-009 | Insecure Cookie Flags | Medium | âœ… Remediated |
| LW-010 | Unrestricted File Upload MIME Type | Medium | âœ… Remediated |
| LW-011 | Booking Slot Race Condition | Medium | âœ… Remediated (confirmed 2026 black-box) |
| LW-012 | Weak Password Policy | Low | âœ… Remediated |
| LW-013 | Outdated Dependency (CVE) | Low | âœ… Remediated |
| LW-014 | HTTP Security Headers | Info | â¬œ No action required |
| LW26-001 | Loyalty Points Mass Assignment | High | ðŸ”´ Open â€” Target: 28 Feb 2026 |
| LW26-002 | SSRF in Media URL Fetcher | High | ðŸ”´ Open â€” Target: 28 Feb 2026 |
| LW26-003 | Analytics Event Flooding | Medium | ðŸŸ¡ Open â€” Target: 31 Mar 2026 |
| LW26-004 | IDOR on Review Deletion | Medium | ðŸŸ¡ Open â€” Target: 31 Mar 2026 |
| LW26-005 | Direct S3 URL Exposure | Medium | ðŸŸ¡ Open â€” Target: 31 Mar 2026 |
| LW26-006 | Missing Pagination on Analytics Export | Medium | ðŸŸ¡ Open â€” Target: 30 Apr 2026 |
| LW26-007 | Outdated Redis npm Package | Low | ðŸŸ¢ Low â€” Next sprint |
| LW26-008 | Kubernetes Pod Running as Root | Low | ðŸŸ¢ Low â€” Next sprint |
| LW26-009 | Missing SRI on CDN Assets | Info | â¬œ No action required |

---

## Retest Schedule

| Retest | Scope | Target Date | Status |
|---|---|---|---|
| 2025 Partial Retest | Critical + High findings (LW-001 to LW-006) | 28 March 2025 | Completed |
| 2025 Full Retest | Medium + Low findings (LW-007 to LW-013) | 30 April 2025 | Completed |
| 2026 Retest 1 | High findings (LW26-001, LW26-002) | 28 February 2026 | Pending |
| 2026 Retest 2 | Medium findings (LW26-003 to LW26-006) | 31 March 2026 | Pending |
| 2027 Annual Assessment | Full scope including new features | February 2027 | Scheduled |

---

## Engagement Firm

**CyberSec Partners Ltd**  
All engagements governed by the Master Services Agreement (MSA) and Statement of Work (SOW) held by the Lomash Wood Head of Engineering.

For retest scheduling or finding clarifications, the Head of Engineering should contact CyberSec Partners at least **5 business days** in advance with:
1. Summary of remediation changes applied
2. Confirmation that the staging environment reflects the patched codebase
3. Any changes to the system architecture since the last engagement

---

## Access & Handling

| Requirement | Detail |
|---|---|
| Classification | CONFIDENTIAL â€” Internal Use Only |
| Permitted Recipients | Head of Engineering, Security Lead, CISO, Backend Architects, DevOps Lead |
| Storage | This directory â€” version-controlled, access restricted to engineering leads |
| Sharing | Written approval from Head of Engineering required before sharing outside the core team |
| Printing | Discouraged; if required, treat as sensitive printed material and shred after use |
| Retention | Retained for a minimum of 3 years per ISO 27001 and SOC 2 requirements |

---

## Related Documents

| Document | Location |
|---|---|
| STRIDE Threat Model | `security/threat-models/STRIDE.md` |
| Attack Tree Analysis | `security/threat-models/attack-tree.md` |
| Security Policies | `security/policies/` |
| Secrets Rotation Procedures | `security/secrets-rotation/` |
| Audit Log Schema | `security/audit-logs/` |
| Incident Response Runbook | `docs/runbooks/outage.md` |
| API Security Policy | `security/policies/api-security.md` |

---

*Last updated: 19 February 2026 â€” CyberSec Partners Ltd / Lomash Wood Engineering*