import type { Notification } from '@prisma/client';
import { FIXED_DATE, FIXED_DATE_STRING, FIXED_FUTURE_DATE, FIXED_UUIDS, FIXED_EMAILS, FIXED_PHONES } from './common.fixture';

export const pendingEmailNotificationFixture: Notification = {
  id:                'clxnotif1000000000000000001',
  channel:           'EMAIL',
  status:            'PENDING',
  priority:          'NORMAL',
  recipientId:       FIXED_UUIDS.USER_1,
  recipientEmail:    FIXED_EMAILS.CUSTOMER_1,
  recipientPhone:    null,
  recipientDevice:   null,
  fromName:          'Lomash Wood',
  fromAddress:       FIXED_EMAILS.NO_REPLY,
  replyTo:           'hello@lomashwood.co.uk',
  templateId:        FIXED_UUIDS.TEMPLATE_1,
  subject:           'Your Lomash Wood appointment is confirmed',
  body:              'Hi John, your appointment is confirmed.',
  htmlBody:          '<h1>Hi John, your appointment is confirmed.</h1>',
  metadata:          { recipientName: 'John Doe' },
  attachments:       null,
  providerId:        null,
  providerMessageId: null,
  providerResponse:  null,
  jobId:             null,
  queueName:         null,
  scheduledAt:       null,
  processedAt:       null,
  sentAt:            null,
  deliveredAt:       null,
  failedAt:          null,
  retryCount:        0,
  maxRetries:        4,
  nextRetryAt:       null,
  lastError:         null,
  lastErrorAt:       null,
  campaignId:        null,
  batchId:           null,
  idempotencyKey:    'idempotency_key_email_001',
  createdAt:         FIXED_DATE,
  updatedAt:         FIXED_DATE,
  deletedAt:         null,
};

export const queuedEmailNotificationFixture: Notification = {
  ...pendingEmailNotificationFixture,
  id:        'clxnotif2000000000000000002',
  status:    'QUEUED',
  jobId:     'bullmq_job_001',
  queueName: 'lomash:email',
  idempotencyKey: 'idempotency_key_email_002',
};

export const sentEmailNotificationFixture: Notification = {
  ...pendingEmailNotificationFixture,
  id:                'clxnotif3000000000000000003',
  status:            'SENT',
  jobId:             'bullmq_job_002',
  queueName:         'lomash:email',
  providerId:        FIXED_UUIDS.PROVIDER_1,
  providerMessageId: 'provider_msg_id_001',
  providerResponse:  { accepted: ['john.doe@example.com'], rejected: [] },
  processedAt:       FIXED_DATE,
  sentAt:            FIXED_DATE,
  idempotencyKey:    'idempotency_key_email_003',
};

export const deliveredEmailNotificationFixture: Notification = {
  ...sentEmailNotificationFixture,
  id:          'clxnotif4000000000000000004',
  status:      'DELIVERED',
  deliveredAt: FIXED_DATE,
  idempotencyKey: 'idempotency_key_email_004',
};

export const failedEmailNotificationFixture: Notification = {
  ...pendingEmailNotificationFixture,
  id:          'clxnotif5000000000000000005',
  status:      'FAILED',
  retryCount:  4,
  failedAt:    FIXED_DATE,
  lastError:   'SMTP connection refused',
  lastErrorAt: FIXED_DATE,
  idempotencyKey: 'idempotency_key_email_005',
};

export const scheduledEmailNotificationFixture: Notification = {
  ...pendingEmailNotificationFixture,
  id:          'clxnotif6000000000000000006',
  status:      'PENDING',
  scheduledAt: FIXED_FUTURE_DATE,
  idempotencyKey: 'idempotency_key_email_006',
};

export const pendingSmsNotificationFixture: Notification = {
  id:                'clxnotif7000000000000000007',
  channel:           'SMS',
  status:            'PENDING',
  priority:          'NORMAL',
  recipientId:       FIXED_UUIDS.USER_1,
  recipientEmail:    null,
  recipientPhone:    FIXED_PHONES.UK_1,
  recipientDevice:   null,
  fromName:          null,
  fromAddress:       FIXED_PHONES.UK_1,
  replyTo:           null,
  templateId:        'clxtmpl60000000000000000006',
  subject:           null,
  body:              'Lomash Wood: Hi John, your appointment is confirmed.',
  htmlBody:          null,
  metadata:          null,
  attachments:       null,
  providerId:        null,
  providerMessageId: null,
  providerResponse:  null,
  jobId:             null,
  queueName:         null,
  scheduledAt:       null,
  processedAt:       null,
  sentAt:            null,
  deliveredAt:       null,
  failedAt:          null,
  retryCount:        0,
  maxRetries:        3,
  nextRetryAt:       null,
  lastError:         null,
  lastErrorAt:       null,
  campaignId:        null,
  batchId:           null,
  idempotencyKey:    'idempotency_key_sms_001',
  createdAt:         FIXED_DATE,
  updatedAt:         FIXED_DATE,
  deletedAt:         null,
};

export const sentSmsNotificationFixture: Notification = {
  ...pendingSmsNotificationFixture,
  id:                'clxnotif8000000000000000008',
  status:            'SENT',
  jobId:             'bullmq_sms_job_001',
  queueName:         'lomash:sms',
  providerId:        'clxprov30000000000000000003',
  providerMessageId: 'SM_twilio_message_id_001',
  providerResponse:  { sid: 'SM_twilio_message_id_001', status: 'sent' },
  processedAt:       FIXED_DATE,
  sentAt:            FIXED_DATE,
  idempotencyKey:    'idempotency_key_sms_002',
};

export const pendingPushNotificationFixture: Notification = {
  id:                'clxnotif9000000000000000009',
  channel:           'PUSH',
  status:            'PENDING',
  priority:          'NORMAL',
  recipientId:       FIXED_UUIDS.USER_1,
  recipientEmail:    null,
  recipientPhone:    null,
  recipientDevice:   'fcm_token_device_001_abcdefghijklmnop',
  fromName:          null,
  fromAddress:       null,
  replyTo:           null,
  templateId:        'clxtmpla0000000000000000010',
  subject:           null,
  body:              'Your appointment is tomorrow at 10:00.',
  htmlBody:          null,
  metadata:          { appointmentRef: 'APT-001' },
  attachments:       null,
  providerId:        null,
  providerMessageId: null,
  providerResponse:  null,
  jobId:             null,
  queueName:         null,
  scheduledAt:       null,
  processedAt:       null,
  sentAt:            null,
  deliveredAt:       null,
  failedAt:          null,
  retryCount:        0,
  maxRetries:        3,
  nextRetryAt:       null,
  lastError:         null,
  lastErrorAt:       null,
  campaignId:        null,
  batchId:           null,
  idempotencyKey:    'idempotency_key_push_001',
  createdAt:         FIXED_DATE,
  updatedAt:         FIXED_DATE,
  deletedAt:         null,
};

export const cancelledNotificationFixture: Notification = {
  ...queuedEmailNotificationFixture,
  id:            'clxnotifa000000000000000010',
  status:        'CANCELLED',
  idempotencyKey: 'idempotency_key_email_cancelled',
};

export const retryingNotificationFixture: Notification = {
  ...failedEmailNotificationFixture,
  id:          'clxnotifb000000000000000011',
  status:      'FAILED',
  retryCount:  2,
  nextRetryAt: FIXED_FUTURE_DATE,
  idempotencyKey: 'idempotency_key_email_retry',
};

export const highPriorityNotificationFixture: Notification = {
  ...pendingEmailNotificationFixture,
  id:       'clxnotifc000000000000000012',
  priority: 'CRITICAL',
  idempotencyKey: 'idempotency_key_email_critical',
};

export const campaignNotificationFixture: Notification = {
  ...sentEmailNotificationFixture,
  id:         'clxnotifd000000000000000013',
  campaignId: FIXED_UUIDS.CAMPAIGN_1,
  batchId:    'batch_campaign_001',
  idempotencyKey: 'idempotency_key_campaign_001',
};

export const allNotificationsFixture: Notification[] = [
  pendingEmailNotificationFixture,
  queuedEmailNotificationFixture,
  sentEmailNotificationFixture,
  deliveredEmailNotificationFixture,
  failedEmailNotificationFixture,
  pendingSmsNotificationFixture,
  sentSmsNotificationFixture,
  pendingPushNotificationFixture,
];